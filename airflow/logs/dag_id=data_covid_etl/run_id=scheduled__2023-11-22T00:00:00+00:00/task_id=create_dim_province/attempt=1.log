[2023-11-26 15:39:36,697] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: data_covid_etl.create_dim_province scheduled__2023-11-22T00:00:00+00:00 [queued]>
[2023-11-26 15:39:36,722] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: data_covid_etl.create_dim_province scheduled__2023-11-22T00:00:00+00:00 [queued]>
[2023-11-26 15:39:36,722] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-11-26 15:39:36,722] {taskinstance.py:1357} INFO - Starting attempt 1 of 6
[2023-11-26 15:39:36,722] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-11-26 15:39:36,787] {taskinstance.py:1377} INFO - Executing <Task(PythonOperator): create_dim_province> on 2023-11-22 00:00:00+00:00
[2023-11-26 15:39:36,799] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'data_covid_etl', 'create_dim_province', 'scheduled__2023-11-22T00:00:00+00:00', '--job-id', '44', '--raw', '--subdir', 'DAGS_FOLDER/get_data.py', '--cfg-path', '/tmp/tmp3adhvy60', '--error-file', '/tmp/tmpugg7jiqb']
[2023-11-26 15:39:36,799] {standard_task_runner.py:80} INFO - Job 44: Subtask create_dim_province
[2023-11-26 15:39:36,792] {standard_task_runner.py:52} INFO - Started process 2530 to run task
[2023-11-26 15:39:36,994] {task_command.py:369} INFO - Running <TaskInstance: data_covid_etl.create_dim_province scheduled__2023-11-22T00:00:00+00:00 [running]> on host f384f2afcc4f
[2023-11-26 15:39:37,237] {taskinstance.py:1571} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=oce
AIRFLOW_CTX_DAG_ID=data_covid_etl
AIRFLOW_CTX_TASK_ID=create_dim_province
AIRFLOW_CTX_EXECUTION_DATE=2023-11-22T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-11-22T00:00:00+00:00
[2023-11-26 15:39:37,238] {python.py:173} INFO - Done. Returned value was: None
[2023-11-26 15:39:37,266] {taskinstance.py:1400} INFO - Marking task as SUCCESS. dag_id=data_covid_etl, task_id=create_dim_province, execution_date=20231122T000000, start_date=20231126T153936, end_date=20231126T153937
[2023-11-26 15:39:37,400] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-11-26 15:39:37,556] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-11-26 17:57:54,669] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: data_covid_etl.create_dim_province scheduled__2023-11-22T00:00:00+00:00 [queued]>
[2023-11-26 17:57:54,679] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: data_covid_etl.create_dim_province scheduled__2023-11-22T00:00:00+00:00 [queued]>
[2023-11-26 17:57:54,679] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-11-26 17:57:54,679] {taskinstance.py:1357} INFO - Starting attempt 1 of 6
[2023-11-26 17:57:54,679] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-11-26 17:57:54,694] {taskinstance.py:1377} INFO - Executing <Task(PythonOperator): create_dim_province> on 2023-11-22 00:00:00+00:00
[2023-11-26 17:57:54,699] {standard_task_runner.py:52} INFO - Started process 762 to run task
[2023-11-26 17:57:54,703] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'data_covid_etl', 'create_dim_province', 'scheduled__2023-11-22T00:00:00+00:00', '--job-id', '136', '--raw', '--subdir', 'DAGS_FOLDER/get_data.py', '--cfg-path', '/tmp/tmpqsca9llu', '--error-file', '/tmp/tmp0l12uuk5']
[2023-11-26 17:57:54,704] {standard_task_runner.py:80} INFO - Job 136: Subtask create_dim_province
[2023-11-26 17:57:54,789] {task_command.py:369} INFO - Running <TaskInstance: data_covid_etl.create_dim_province scheduled__2023-11-22T00:00:00+00:00 [running]> on host 79a606f4be36
[2023-11-26 17:57:54,863] {taskinstance.py:1571} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=oce
AIRFLOW_CTX_DAG_ID=data_covid_etl
AIRFLOW_CTX_TASK_ID=create_dim_province
AIRFLOW_CTX_EXECUTION_DATE=2023-11-22T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-11-22T00:00:00+00:00
[2023-11-26 17:57:54,864] {taskinstance.py:1889} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/get_data.py", line 38, in create_dim_province
    engine = create_engine(staging_db_constring)
NameError: name 'create_engine' is not defined
[2023-11-26 17:57:54,871] {taskinstance.py:1400} INFO - Marking task as UP_FOR_RETRY. dag_id=data_covid_etl, task_id=create_dim_province, execution_date=20231122T000000, start_date=20231126T175754, end_date=20231126T175754
[2023-11-26 17:57:54,883] {standard_task_runner.py:97} ERROR - Failed to execute job 136 for task create_dim_province (name 'create_engine' is not defined; 762)
[2023-11-26 17:57:54,914] {local_task_job.py:156} INFO - Task exited with return code 1
[2023-11-26 17:57:54,964] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-11-26 18:15:26,722] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: data_covid_etl.create_dim_province scheduled__2023-11-22T00:00:00+00:00 [queued]>
[2023-11-26 18:15:26,732] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: data_covid_etl.create_dim_province scheduled__2023-11-22T00:00:00+00:00 [queued]>
[2023-11-26 18:15:26,732] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-11-26 18:15:26,732] {taskinstance.py:1357} INFO - Starting attempt 1 of 3
[2023-11-26 18:15:26,732] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-11-26 18:15:26,748] {taskinstance.py:1377} INFO - Executing <Task(PythonOperator): create_dim_province> on 2023-11-22 00:00:00+00:00
[2023-11-26 18:15:26,753] {standard_task_runner.py:52} INFO - Started process 1640 to run task
[2023-11-26 18:15:26,756] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'data_covid_etl', 'create_dim_province', 'scheduled__2023-11-22T00:00:00+00:00', '--job-id', '267', '--raw', '--subdir', 'DAGS_FOLDER/get_data.py', '--cfg-path', '/tmp/tmpxs7rgamw', '--error-file', '/tmp/tmp2pna_1ul']
[2023-11-26 18:15:26,757] {standard_task_runner.py:80} INFO - Job 267: Subtask create_dim_province
[2023-11-26 18:15:26,804] {task_command.py:369} INFO - Running <TaskInstance: data_covid_etl.create_dim_province scheduled__2023-11-22T00:00:00+00:00 [running]> on host 79a606f4be36
[2023-11-26 18:15:26,880] {taskinstance.py:1571} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=oce
AIRFLOW_CTX_DAG_ID=data_covid_etl
AIRFLOW_CTX_TASK_ID=create_dim_province
AIRFLOW_CTX_EXECUTION_DATE=2023-11-22T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-11-22T00:00:00+00:00
[2023-11-26 18:15:26,907] {logging_mixin.py:115} INFO - province_id province_name
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
         32    Jawa Barat
[2023-11-26 18:15:26,922] {taskinstance.py:1889} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/get_data.py", line 46, in create_dim_province
    df.to_sql('dim_province', engine_postgres, index=False, if_exists='replace')
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1758, in to_sql
    dtype=dtype,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1650, in prep_table
    table.create()
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 860, in create
    self.pd_sql.drop_table(self.name, self.schema)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1809, in drop_table
    self.meta.reflect(only=[table_name], schema=schema)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/schema.py", line 4705, in reflect
    "in %r%s: (%s)" % (bind.engine, s, ", ".join(missing))
sqlalchemy.exc.InvalidRequestError: Could not reflect: requested table(s) not available in Engine(postgresql://postgres:***@192.168.122.17:5435/dwh): (dim_province)
[2023-11-26 18:15:26,931] {taskinstance.py:1400} INFO - Marking task as UP_FOR_RETRY. dag_id=data_covid_etl, task_id=create_dim_province, execution_date=20231122T000000, start_date=20231126T181526, end_date=20231126T181526
[2023-11-26 18:15:26,943] {standard_task_runner.py:97} ERROR - Failed to execute job 267 for task create_dim_province (Could not reflect: requested table(s) not available in Engine(postgresql://postgres:***@192.168.122.17:5435/dwh): (dim_province); 1640)
[2023-11-26 18:15:26,970] {local_task_job.py:156} INFO - Task exited with return code 1
[2023-11-26 18:15:27,013] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
